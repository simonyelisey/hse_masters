# Прогнозирование цен на автомобили

## Обзор

В данной работе проводится анализ данных с характеристиками различных автомобилей и их ценой, а также создается сервис 
для прогноза цен на новые объекты:
- прогноз отдельного объекта;
- прогноз группы объектов, путем загрузки CSV-файла.

Описание файлов:
- `main.py` - реализация FastAPI;
- `fit.ipynb` - анализ данных и обучение моделей;
- `preparing_functions.py` - функции по продобработке данных;
- `data/prediction.csv` - тестовая выборка с прогнозом.

Описание папок:
- `screenshots` - скриншоты работы FastAPI;
- `pickle_files` - сохраненные модели по предобработке и прогнозированию данных в формате .pkl.

## Предобработка данных

Основные шаги по предобработке данных:
- экстракция из признака torque двух новых признаков: Nm крутящего момента и rpm - количество оборотов в минуту;
- экстракция числовых значений из признаков: mileage, max_power и engine;
- заполнение пропусков;
- стандартизация вещественных признаков;
- кодирование категориальных признаков методом OneHotEncoding.

## Моделирование

В условии задачи рекомендуется применять только линейные модели, поэтому были применены:
- Linear Regression;
- Lasso & Ridge Regression;
- GridSearchCV для подбора гиперпараметров.

## Удачные подходы

- Логарифмировние целевой переменной дало самый большой буст: R2: 0.12 -> 0.67, MSE: 96715672791 -> 54012485320;
- Удаление выбросов из признаков: max_power и rpm_torque улучшило метрику и лосс еще на ~1%.

## Финальные метрики

**R2** = 0.69

**MSE** = 99994313805

## Что не успел

- борьба с мультиколлиниарностью;
- более глубокий feature engineering.